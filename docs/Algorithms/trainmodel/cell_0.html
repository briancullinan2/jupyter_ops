<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>Cell 0</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
  <style>
    html {
      padding: 0;
      margin: 0;
    }

    nav {
      position: fixed;
      overflow: auto;
      top: 0;
      left: 0;
      right: auto;
      bottom: 0;
      width: 200px;
    }

    header {
      background-color: #EEE;
      padding: 10px;
    }

    body {
      padding: 0 0 0 200px;
      margin: 0;
    }

    .gold pre code,
    .gold pre code span,
    .gold code pre,
    .gold code pre span {
      color: gold;
    }

    @media screen and (max-width: 600px) {
      body {
        padding-left: 0;
      }

      nav {
        display: none;
      }
    }
  </style>
</head>

<body>
  <nav>
    <h3><a href="../trainmodel/index.html">trainmodel</a></h3>
    <a href="./cell_0.html">Cell 0</a>
<br /><br />
<a href="./cell_1.html">Cell 1</a>
<br /><br />
<a href="./cell_2.html">Cell 2</a>
<br /><br />
<a href="./cell_3.html">Cell 3</a>
<br /><br />
<a href="./cell_4.html">Cell 4</a>
<br /><br />
<a href="./cell_5.html">Cell 5</a>
<br /><br />
<a href="./cell_6.html">Cell 6</a>
<br /><br />
<a href="./cell_7.html">Cell 7</a>
<br /><br />
<a href="./cell_8.html">Cell 8</a>
<br /><br />
<a href="./cell_9.html">Cell 9</a>
<br /><br />
<a href="./cell_10.html">Cell 10</a>
<br /><br />
<a href="./cell_11.html">Cell 11</a>
<br /><br />
<a href="./cell_12.html">Cell 12</a>
<br /><br />
<a href="./cell_13.html">Cell 13</a>
<br /><br />
<a href="./cell_14.html">Cell 14</a>
<br /><br />
<a href="./cell_15.html">Cell 15</a>
<br /><br />
<a href="./cell_16.html">Cell 16</a>
<br /><br />
<a href="./cell_17.html">Cell 17</a>
<br /><br />
<a href="./cell_18.html">Cell 18</a>
<br /><br />
<a href="./cell_19.html">Cell 19</a>
<br /><br />
<a href="./cell_20.html">Cell 20</a>
<br /><br />
<a href="./cell_21.html">Cell 21</a>
<br /><br />
<a href="./cell_22.html">Cell 22</a>
<br /><br />
<a href="./cell_23.html">Cell 23</a>
<br /><br />
<a href="./cell_24.html">Cell 24</a>
<br /><br />
<a href="./cell_25.html">Cell 25</a>
<br /><br />
<a href="./cell_26.html">Cell 26</a>
<br /><br />
<a href="./cell_27.html">Cell 27</a>
<br /><br />
<a href="./cell_28.html">Cell 28</a>
<br /><br />
<a href="./cell_29.html">Cell 29</a>
<br /><br />
<a href="./cell_30.html">Cell 30</a>
<br /><br />
<a href="./cell_31.html">Cell 31</a>
<br /><br />

  </nav>
  <header>
    <a href="../trainmodel/index.html">trainmodel</a> |  | <a href="./cell_1.html">Cell 1</a> | <a href="../../search.html">Search</a>
  </header>

  <p>This code imports necessary libraries, including Keras for building neural networks, and additional libraries like Pandas for data manipulation and NumPy for numerical computation, as well as the os module for operating system functions. The imported libraries are used for tasks such as image processing, data analysis, and neural network model creation.</p>
<h1>Cell 0</h1>



<pre class="python"><code>from keras.utils import to_categorical
from keras_preprocessing.image import load_img
from keras.models import Sequential
from keras.layers import Dense, Conv2D, Dropout, Flatten, MaxPooling2D
import os
import pandas as pd
import numpy as np</code></pre>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.css">


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
<script src="../../mergehtml.js"></script>

<script>
hljs.addPlugin(mergeHTMLPlugin);
hljs.highlightAll();
</script>

<div class="gold"><h2>What the code could have been:</h2>
<pre class="python"><code># Import libraries for image processing and neural network
from keras.preprocessing.image import load_img, img_to_array
from keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Conv2D, Dropout, Flatten, MaxPooling2D
import os
import pandas as pd
import numpy as np

# Constants
IMAGE_SIZE = (256, 256)  # resize image size
BATCH_SIZE = 32  # batch size for training
EPOCHS = 10  # number of epochs for training

# Load Image
def load_image(file_path):
    """
    Load image from file path and resize it to IMAGE_SIZE.
    
    Args:
    file_path (str): path to the image file.
    
    Returns:
    image (numpy array): resized image.
    """
    image = load_img(file_path, target_size=IMAGE_SIZE)
    return img_to_array(image)

# Load Dataset
def load_dataset(data_dir):
    """
    Load dataset from directory and convert image paths to numpy arrays.
    
    Args:
    data_dir (str): path to the dataset directory.
    
    Returns:
    images (numpy array): numpy array of image data.
    labels (numpy array): numpy array of labels.
    """
    images = []
    labels = []
    for category in os.listdir(data_dir):
        category_dir = os.path.join(data_dir, category)
        for file in os.listdir(category_dir):
            file_path = os.path.join(category_dir, file)
            image = load_image(file_path)
            images.append(image)
            labels.append(int(category))
    return np.array(images), np.array(labels)

# Preprocess Data
def preprocess_data(images, labels):
    """
    Convert image data to categorical labels and one-hot encode labels.
    
    Args:
    images (numpy array): numpy array of image data.
    labels (numpy array): numpy array of labels.
    
    Returns:
    images (numpy array): numpy array of image data.
    labels (numpy array): numpy array of one-hot encoded labels.
    """
    images = images / 255  # normalize pixel values
    labels = to_categorical(labels)  # one-hot encode labels
    return images, labels

# Build Model
def build_model():
    """
    Build neural network model using Sequential API.
    
    Returns:
    model (keras model): built neural network model.
    """
    model = Sequential()
    model.add(Conv2D(32, (3, 3), activation='relu', input_shape=(IMAGE_SIZE[0], IMAGE_SIZE[1], 3)))
    model.add(MaxPooling2D((2, 2)))
    model.add(Conv2D(64, (3, 3), activation='relu'))
    model.add(MaxPooling2D((2, 2)))
    model.add(Conv2D(128, (3, 3), activation='relu'))
    model.add(MaxPooling2D((2, 2)))
    model.add(Flatten())
    model.add(Dense(128, activation='relu'))
    model.add(Dropout(0.2))
    model.add(Dense(len(os.listdir(data_dir)), activation='softmax'))
    model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])
    return model

# Train Model
def train_model(model, images, labels):
    """
    Train neural network model on dataset.
    
    Args:
    model (keras model): built neural network model.
    images (numpy array): numpy array of image data.
    labels (numpy array): numpy array of one-hot encoded labels.
    """
    model.fit(images, labels, batch_size=BATCH_SIZE, epochs=EPOCHS, validation_split=0.2)

# Main Function
def main():
    data_dir = 'path/to/dataset'  # replace with actual dataset path
    images, labels = load_dataset(data_dir)
    images, labels = preprocess_data(images, labels)
    model = build_model()
    train_model(model, images, labels)

if __name__ == '__main__':
    main()</code></pre></div><h2>Code Breakdown</h2>
<h3>Importing Libraries</h3>
<pre><code class="language-python">from keras.utils import to_categorical
from keras_preprocessing.image import load_img
from keras.models import Sequential
from keras.layers import Dense, Conv2D, Dropout, Flatten, MaxPooling2D
</code></pre>
<ul>
<li><code>keras.utils</code>: Contains utility functions for use during training.</li>
<li><code>keras_preprocessing.image</code>: Provides functions for working with images.</li>
<li><code>keras.models</code>: Allows the creation of neural network models.</li>
<li><code>keras.layers</code>: Offers pre-built layers to add to the model.</li>
</ul>
<h3>Importing Additional Libraries</h3>
<pre><code class="language-python">import os
import pandas as pd
import numpy as np
</code></pre>
<ul>
<li><code>os</code>: Provides a way of using operating system dependent functionality.</li>
<li><code>pandas</code>: A library for data manipulation and analysis.</li>
<li><code>numpy</code>: A library for efficient numerical computation.</li>
</ul>

</body>

</html>