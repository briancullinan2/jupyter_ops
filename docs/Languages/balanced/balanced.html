<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>balanced</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
  <style>
    nav {
      position: fixed;
      overflow: auto;
      top: 0;
      left: 0;
      right: auto;
      bottom: 0;
      width: 200px;
    }

    header {
      background-color: #EEE;
    }

    body {
      padding-left: 200px;
    }

    @media screen and (max-width: 600px) {
      body {
        padding-left: 0;
      }

      nav {
        display: none;
      }
    }
  </style>
</head>

<body>
  <nav>
    <a href="../balanced/index.html">balanced</a>
    <br /><br />
    <a href="./balanced.html">balanced</a>
<br /><br />
<a href="./cell_1.html">Cell 1</a>
<br /><br />

  </nav>
  <header>
    <a href="../balanced/index.html">balanced</a> ${PREV} ${NEXT}
  </header>

  <p>The <code>balanced</code> function identifies and extracts a balanced substring within a given string, delimited by two specified markers, <code>a</code> and <code>b</code>. It handles potential nested delimiters and returns information about the balanced substring's position and content.</p>


<pre class="javascript"><code>module.exports = balanced;
function balanced(a, b, str) {
  if (a instanceof RegExp) a = maybeMatch(a, str);
  if (b instanceof RegExp) b = maybeMatch(b, str);

  var r = range(a, b, str);

  return r && {
    start: r[0],
    end: r[1],
    pre: str.slice(0, r[0]),
    body: str.slice(r[0] + a.length, r[1]),
    post: str.slice(r[1] + b.length)
  };
}

function maybeMatch(reg, str) {
  var m = str.match(reg);
  return m ? m[0] : null;
}

balanced.range = range;
function range(a, b, str) {
  var begs, beg, left, right, result;
  var ai = str.indexOf(a);
  var bi = str.indexOf(b, ai + 1);
  var i = ai;

  if (ai >= 0 && bi > 0) {
    begs = [];
    left = str.length;

    while (i >= 0 && !result) {
      if (i == ai) {
        begs.push(i);
        ai = str.indexOf(a, i + 1);
      } else if (begs.length == 1) {
        result = [ begs.pop(), bi ];
      } else {
        beg = begs.pop();
        if (beg < left) {
          left = beg;
          right = bi;
        }

        bi = str.indexOf(b, i + 1);
      }

      i = ai < bi && ai >= 0 ? ai : bi;
    }

    if (begs.length) {
      result = [ left, right ];
    }
  }

  return result;
}</code></pre>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.css">


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>

<script>hljs.highlightAll();</script>

<p>This code defines a function <code>balanced</code> that finds a balanced substring within a given string <code>str</code> based on two delimiters, <code>a</code> and <code>b</code>.</p>
<p>Here's a breakdown:</p>
<ul>
<li><p><strong><code>balanced(a, b, str)</code>:</strong></p>
<ul>
<li>Takes two delimiters (<code>a</code> and <code>b</code>) and a string <code>str</code> as input.</li>
<li>If <code>a</code> or <code>b</code> are regular expressions, it uses <code>maybeMatch</code> to find the first match in <code>str</code>.</li>
<li>Calls <code>range</code> to find the indices of the balanced substring.</li>
<li>Returns an object containing the start and end indices, the substring before and after the balanced part, and the balanced substring itself.</li>
</ul></li>
<li><p><strong><code>maybeMatch(reg, str)</code>:</strong></p>
<ul>
<li>Attempts to match a regular expression <code>reg</code> against <code>str</code>.</li>
<li>Returns the matched substring if found, otherwise <code>null</code>.</li>
</ul></li>
<li><p><strong><code>range(a, b, str)</code>:</strong></p>
<ul>
<li>Finds the indices of the first occurrence of <code>a</code> and <code>b</code> in <code>str</code>, ensuring <code>b</code> appears after <code>a</code>.</li>
<li>Iteratively searches for balanced occurrences, handling nested delimiters.</li>
<li>Returns an array containing the start and end indices of the balanced substring.</li>
</ul></li>
</ul>
<p>Let me know if you'd like a more detailed explanation of any specific part!</p>

</body>

</html>