<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>calendar search heatmap</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
  <style>
    html {
      padding: 0;
      margin: 0;
    }

    nav {
      position: fixed;
      overflow: auto;
      top: 0;
      left: 0;
      right: auto;
      bottom: 0;
      width: 200px;
    }

    header {
      background-color: #EEE;
      padding: 10px;
    }

    body {
      padding: 0 0 0 200px;
      margin: 0;
    }

    @media screen and (max-width: 600px) {
      body {
        padding-left: 0;
      }

      nav {
        display: none;
      }
    }
  </style>
</head>

<body>
  <nav>
    <h3><a href="../google_scheduling/index.html">google scheduling</a></h3>
    <a href="./space_out_purple_event.html">space out purple event</a>
<br /><br />
<a href="./__schedule_study_time.html">, schedule study time</a>
<br /><br />
<a href="./schedule_inside_outside_of_time_bounds.html">schedule inside outside of time bounds</a>
<br /><br />
<a href="./remove_overlaps.html">remove overlaps</a>
<br /><br />
<a href="./prioritize_events_based_on_glob_summary.html">prioritize events based on glob summary</a>
<br /><br />
<a href="./calendar_search_heatmap.html">calendar search heatmap</a>
<br /><br />
<a href="./search_calendar.html">search calendar</a>
<br /><br />
<a href="./cell_7.html">Cell 7</a>
<br /><br />

  </nav>
  <header>
    <a href="../google_scheduling/index.html">google scheduling</a> | <a href="./prioritize_events_based_on_glob_summary.html">prioritize events based on glob summary</a> | <a href="./search_calendar.html">search calendar</a>
  </header>

  <p>This code generates a heatmap visualization of Google Calendar events based on specified keywords, calculating the total time spent on those events.  It uses the Google Calendar API to fetch events, calculates event durations, and visualizes the results using a heatmap.</p>
<h2>Run example</h2>

<pre language="bash"><code>npm run import -- "calendar search heatmap"</code></pre><h1>calendar search heatmap</h1>



<pre class="javascript"><code>var importer = require('../Core');
var {
    getOauthClient,
    d3Heatmap,
    listEvents,
    correctCalendarId,
    sumEvents
} = importer.import([
    'import google calendar api',
    'd3 calendar',
    'list events',
    'lookup calendar name',
    'sum a list of events'
]);

var options = {
    
}

function calendarHeatmap(search, calendar) {
    if(calendar) {
        options.calendarId = calendar;
    }
    var total = 0;
    return getOauthClient(options)
        .then(() =&gt; correctCalendarId(options))
        .then(() =&gt; importer.runAllPromises(search.split('|').map(term =&gt; resolve =&gt; {
            return listEvents({
                auth: options.auth,
                calendarId: options.calendarId,
                q: term
            }).then(r =&gt; {
                console.log(term);
                console.log(r.map(e =&gt; e.event.summary).slice(0, 10));
                const hours = sumEvents(r);
                console.log(hours + ' hrs');
                total += hours;
                return resolve(r);
            })
        })))
        .then(r =&gt; [].concat(...r.map((e, i) =&gt; ({
            id: e.id,
            start: new Date(e.event.start.dateTime),
            end: new Date(e.event.end.dateTime),
        }))))
        .then(r =&gt; {
            console.log(total + ' hrs total');
            console.log((total / 41) + ' hrs / week') // subtract from 48 weeks, 2 weeks of mental health, 2 weeks of holidays
            return [d3Heatmap(r)]
        })
}
module.exports = calendarHeatmap;

if(typeof $ !== 'undefined') {
    $.async();
//    calendarHeatmap('work')
    calendarHeatmap('portal|eloqua|zuora|angular|webpack|renewals|unit test|unit tests|unit testing|selenium|angular2|pricing|jupytangular|notebook|work|sos|study sauce|notebooks|jupyter|cloud|docker|build')
    /*
    5776.5 hrs total
    120.34375 hrs / week
    */
//    calendarHeatmap('portal|eloqua|zuora|angular|webpack|renewals|unit test|unit tests|unit testing|selenium|angular2|pricing')
//    calendarHeatmap('portal')
    /*
    1353.75 hrs total
    28.203125 hrs / week
    */
        .then(r =&gt; $.html(r[0]))
        .catch(e =&gt; $.sendError(e))
}
</code></pre>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.css">


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>

<script>hljs.highlightAll();</script>

<p>This code snippet is designed to generate a heatmap visualization of events from a Google Calendar based on keywords.</p>
<p>Here's a breakdown:</p>
<ol>
<li><p><strong>Dependencies:</strong> It imports functions for interacting with the Google Calendar API, creating a heatmap, listing events, and handling calendar IDs.</p></li>
<li><p><strong>Configuration:</strong> It sets up options for interacting with the Google Calendar, including the calendar ID.</p></li>
<li><p><strong><code>calendarHeatmap</code> Function:</strong></p>
<ul>
<li>Takes a search term (keywords) and an optional calendar ID.</li>
<li>Fetches events from the Google Calendar matching the search term.</li>
<li>Calculates the total hours spent on events based on their duration.</li>
<li>Generates a heatmap visualization using the <code>d3Heatmap</code> function, likely displaying event occurrences over time.</li>
</ul></li>
<li><p><strong>Execution:</strong></p>
<ul>
<li>The code includes an example usage of the <code>calendarHeatmap</code> function with a list of keywords.</li>
<li>It calculates the total hours spent on events and displays the result.</li>
</ul></li>
</ol>

</body>

</html>